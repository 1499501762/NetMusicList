# GitHub Actions å·¥ä½œæµä½¿ç”¨è¯´æ˜

æœ¬é¡¹ç›®é…ç½®äº†ä¸¤ä¸ª GitHub Actions å·¥ä½œæµï¼Œç”¨äºè‡ªåŠ¨åŒ–æ„å»ºã€æµ‹è¯•å’Œå‘å¸ƒã€‚

## ğŸ“‹ å·¥ä½œæµæ¦‚è§ˆ

### 1. Build and Testï¼ˆæ„å»ºå’Œæµ‹è¯•ï¼‰
**æ–‡ä»¶**: `.github/workflows/build.yml`

**è§¦å‘æ¡ä»¶**:
- æ¨é€åˆ° `master`ã€`main` æˆ– `develop` åˆ†æ”¯
- é’ˆå¯¹ `master` æˆ– `main` åˆ†æ”¯çš„ Pull Request

**åŠŸèƒ½**:
- âœ… è®¾ç½® Java 21 ç¯å¢ƒ
- âœ… æ£€æŸ¥ä¾èµ–æ–‡ä»¶ï¼ˆNetMusic æ¨¡ç»„ï¼‰
- âœ… ç¼–è¯‘é¡¹ç›®
- âœ… è¿è¡Œæµ‹è¯•
- âœ… ä¸Šä¼ æ„å»ºäº§ç‰©ï¼ˆä¿ç•™ 7 å¤©ï¼‰
- âœ… ä»£ç è´¨é‡æ£€æŸ¥

### 2. Release on Tagï¼ˆæ ‡ç­¾å‘å¸ƒï¼‰
**æ–‡ä»¶**: `.github/workflows/release.yml`

**è§¦å‘æ¡ä»¶**:
- æ¨é€æ ¼å¼ä¸º `v*.*.*` çš„æ ‡ç­¾ï¼ˆä¾‹å¦‚ï¼š`v1.0.0`, `v1.2.3`ï¼‰

**åŠŸèƒ½**:
- âœ… è‡ªåŠ¨æ›´æ–°ç‰ˆæœ¬å·
- âœ… æ„å»ºå‘å¸ƒç‰ˆæœ¬
- âœ… ç”Ÿæˆå˜æ›´æ—¥å¿—
- âœ… åˆ›å»º GitHub Release
- âœ… ä¸Šä¼  jar æ–‡ä»¶å’Œæ–‡æ¡£

## ğŸš€ å¦‚ä½•ä½¿ç”¨

### æ—¥å¸¸å¼€å‘ï¼ˆè‡ªåŠ¨æ„å»ºï¼‰

1. **æ­£å¸¸æäº¤ä»£ç **
   ```bash
   git add .
   git commit -m "feat: æ·»åŠ æ–°åŠŸèƒ½"
   git push origin master
   ```

2. **å·¥ä½œæµè‡ªåŠ¨è¿è¡Œ**
   - è®¿é—® GitHub ä»“åº“çš„ "Actions" æ ‡ç­¾é¡µ
   - æŸ¥çœ‹æ„å»ºçŠ¶æ€å’Œæ—¥å¿—
   - ä¸‹è½½æ„å»ºäº§ç‰©è¿›è¡Œæµ‹è¯•

### å‘å¸ƒæ–°ç‰ˆæœ¬

#### æ­¥éª¤ 1: å‡†å¤‡ä¾èµ–æ–‡ä»¶

âš ï¸ **é‡è¦**: å‘å¸ƒå‰å¿…é¡»ç¡®ä¿ `libs` æ–‡ä»¶å¤¹ä¸­æœ‰ NetMusic æ¨¡ç»„çš„ jar æ–‡ä»¶ï¼

```bash
# åˆ›å»º libs æ–‡ä»¶å¤¹ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
mkdir libs

# å°† netmusic-1.21.1-x.x.x.jar å¤åˆ¶åˆ° libs æ–‡ä»¶å¤¹
cp /path/to/netmusic-1.21.1-x.x.x.jar libs/

# æäº¤ä¾èµ–æ–‡ä»¶ï¼ˆå¦‚æœéœ€è¦ï¼‰
git add libs/
git commit -m "chore: æ·»åŠ  NetMusic ä¾èµ–"
git push
```

#### æ­¥éª¤ 2: åˆ›å»ºå¹¶æ¨é€æ ‡ç­¾

```bash
# åˆ›å»ºæ ‡ç­¾ï¼ˆéµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼‰
git tag -a v1.1.0 -m "Release version 1.1.0"

# æ¨é€æ ‡ç­¾åˆ°è¿œç¨‹ä»“åº“
git push origin v1.1.0
```

#### æ­¥éª¤ 3: ç­‰å¾…è‡ªåŠ¨å‘å¸ƒ

1. è®¿é—® "Actions" é¡µé¢æŸ¥çœ‹å‘å¸ƒè¿›åº¦
2. å·¥ä½œæµä¼šè‡ªåŠ¨ï¼š
   - æ„å»ºé¡¹ç›®
   - ç”Ÿæˆå˜æ›´æ—¥å¿—
   - åˆ›å»º GitHub Release
   - ä¸Šä¼  jar æ–‡ä»¶

3. å‘å¸ƒå®Œæˆåï¼Œåœ¨ "Releases" é¡µé¢æŸ¥çœ‹

## ğŸ“¦ ç‰ˆæœ¬å·è§„èŒƒ

ä½¿ç”¨[è¯­ä¹‰åŒ–ç‰ˆæœ¬](https://semver.org/lang/zh-CN/)ï¼š

- `v1.0.0` - ä¸»ç‰ˆæœ¬ï¼ˆé‡å¤§å˜æ›´ï¼‰
- `v1.1.0` - æ¬¡ç‰ˆæœ¬ï¼ˆæ–°åŠŸèƒ½ï¼‰
- `v1.1.1` - ä¿®è®¢ç‰ˆæœ¬ï¼ˆbug ä¿®å¤ï¼‰
- `v1.2.0-beta.1` - é¢„å‘å¸ƒç‰ˆæœ¬
- `v2.0.0-rc.1` - å€™é€‰å‘å¸ƒç‰ˆæœ¬

**é¢„å‘å¸ƒç‰ˆæœ¬**ä¼šè¢«æ ‡è®°ä¸º "Pre-release"ã€‚

## ğŸ”§ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹è§¦å‘åˆ†æ”¯

ç¼–è¾‘ `.github/workflows/build.yml`:

```yaml
on:
  push:
    branches: [ master, main, develop, feature/* ]  # æ·»åŠ æ›´å¤šåˆ†æ”¯
```

### ä¿®æ”¹æ ‡ç­¾æ ¼å¼

ç¼–è¾‘ `.github/workflows/release.yml`:

```yaml
on:
  push:
    tags:
      - 'v*.*.*'      # æ ‡å‡†ç‰ˆæœ¬
      - 'v*.*.*-*'    # åŒ…å«é¢„å‘å¸ƒç‰ˆæœ¬
```

### æ·»åŠ è‡ªåŠ¨å‘å¸ƒåˆ° Modrinth/CurseForge

åœ¨ `release.yml` æœ«å°¾æ·»åŠ ï¼š

```yaml
- name: å‘å¸ƒåˆ° Modrinth
  uses: Kir-Antipov/mc-publish@v3.3
  with:
    modrinth-token: ${{ secrets.MODRINTH_TOKEN }}
    modrinth-id: your-project-id
    files: release/*.jar
```

## ğŸ› æ•…éšœæ’é™¤

### æ„å»ºå¤±è´¥ï¼šç¼ºå°‘ NetMusic ä¾èµ–

**é—®é¢˜**: `Could not find blank:netmusic-1.21.1:1.2.1`

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®ä¿ `libs` æ–‡ä»¶å¤¹å­˜åœ¨å¹¶åŒ…å« NetMusic jar æ–‡ä»¶
2. å–æ¶ˆ `build.gradle` ç¬¬ 32 è¡Œçš„æ³¨é‡Š
3. æˆ–è€…åˆ›å»º GitHub Secret å­˜å‚¨ä¾èµ–æ–‡ä»¶çš„ä¸‹è½½é“¾æ¥

### Java ç‰ˆæœ¬é”™è¯¯

**é—®é¢˜**: `error: invalid target release: 21`

**è§£å†³æ–¹æ¡ˆ**: å·¥ä½œæµå·²é…ç½® Java 21ï¼Œæ— éœ€ä¿®æ”¹ã€‚å¦‚æœä»æœ‰é—®é¢˜ï¼Œæ£€æŸ¥ `build.gradle` ä¸­çš„ Java ç‰ˆæœ¬è®¾ç½®ã€‚

### æ ‡ç­¾æ¨é€åæ²¡æœ‰è§¦å‘å‘å¸ƒ

**æ£€æŸ¥**:
1. æ ‡ç­¾æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼ˆå¿…é¡»æ˜¯ `v*.*.*`ï¼‰
2. æ˜¯å¦æœ‰æƒé™åˆ›å»º Release
3. æŸ¥çœ‹ Actions é¡µé¢çš„é”™è¯¯æ—¥å¿—

## ğŸ“ æœ€ä½³å®è·µ

1. **æäº¤å‰æœ¬åœ°æµ‹è¯•**
   ```bash
   ./gradlew clean build
   ```

2. **ç¼–å†™æ¸…æ™°çš„æäº¤ä¿¡æ¯**
   - `feat:` - æ–°åŠŸèƒ½
   - `fix:` - Bug ä¿®å¤
   - `docs:` - æ–‡æ¡£æ›´æ–°
   - `chore:` - æ„å»º/å·¥å…·å˜æ›´

3. **ä½¿ç”¨ Pull Request**
   - é‡å¤§å˜æ›´é€šè¿‡ PR å®¡æŸ¥
   - è‡ªåŠ¨è¿è¡Œæ„å»ºæµ‹è¯•

4. **å®šæœŸå‘å¸ƒ**
   - ç§¯ç´¯è¶³å¤Ÿå˜æ›´åå‘å¸ƒ
   - éµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ
   - æ›´æ–° CHANGELOG

## ğŸ”— ç›¸å…³é“¾æ¥

- [GitHub Actions æ–‡æ¡£](https://docs.github.com/actions)
- [è¯­ä¹‰åŒ–ç‰ˆæœ¬](https://semver.org/lang/zh-CN/)
- [Conventional Commits](https://www.conventionalcommits.org/zh-hans/)
